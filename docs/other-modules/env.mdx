---
title: 'Env'
description: 'Orion Env is a utility for managing a collection of secrets in source control.'
---

The secrets are encrypted using public key, elliptic curve cryptography.

> This package works as standlaone package. It does not depend on any other orionjs package.

It's like dotEnv but saved in source control.

## Creating a new Env config file

Run the following script in a project that has the package installed. Save the password output because you will need to use it to decrypt the keys.

```sh
yarn orion-env init --path=<path>
```

## Adding a new env variable

Run the following script in a project that has the package installed and you will be prompted for the variable name and value.

```sh
yarn orion-env add --path=<path>
```

## Using in your app

Define the following environment variables (in the old way):

- `ORION_ENV_FILE_PATH=<path>` The path to the env file.
- `ORION_ENV_SECRET_KEY=<password>` The password to decrypt the keys.

Then you can access the variables by importing the package and all the env variables defined will be the env object.

```ts
import {env} from '@orion-js/env'

env.XX
```

## Setting environment variables (process.env)

To add backwards compatibility you can also use this libary to set the environment variables.

```ts
import {loadEnv} from '@orion-js/env'

loadEnv()
```

This will set the environment variables for the current process.

Options:

- `secretKey` Secret password used to decrypt the encrypted env file. Default: process.env.ORION_ENV_SECRET_KEY
- `envFilePath` Location of the file to read. Default: process.env.ORION_ENV_FILE_PATH
- `override` Set to true to set the environment variables even if the variable was already set. Default: process.env.ORION_ENV_OVERRIDE

## Reading variables from Secret Managers

You can configure Orion Env to read certain variables from JSON-formatted environment variables, which can be populated from secret managers like AWS Secrets Manager or similar services.

This is useful when you want to store sensitive information in a secret manager but still use the Orion Env system to access them.

### Configuration

In your env file, you can add a `readFromSecret` section that maps environment variable names to arrays of variable keys that should be read from those environment variables:

```yaml
version: '1'
publicKey: '...'
cleanKeys:
  # ...
encryptedKeys:
  # ...
readFromSecret:
  MY_SECRET_JSON:
    - DATABASE_URL
    - API_KEY
  ANOTHER_SECRET:
    - OTHER_VAR1
    - OTHER_VAR2
```

### How it works

1. For each key in the `readFromSecret` object (e.g., "MY_SECRET_JSON"), Orion Env will look for an environment variable with that name.
2. If found, it tries to parse the value as JSON.
3. For each variable name in the array (e.g., "DATABASE_URL", "API_KEY"), it will look for corresponding properties in the parsed JSON.
4. If found, these values will be available in the `env` object just like other variables.

### Secret Key Discovery

Additionally, if the JSON content contains an `ORION_ENV_SECRET_KEY` property, Orion Env will use that value as the secret key for decrypting encrypted variables. This means you can store your decryption password in the secret manager as well.

For example, if `process.env.MY_SECRET_JSON` contains:

```json
{
  "DATABASE_URL": "postgresql://user:pass@localhost:5432/db",
  "API_KEY": "xyz123",
  "ORION_ENV_SECRET_KEY": "my-decryption-password"
}
```

Then Orion Env will:
1. Set `env.DATABASE_URL` and `env.API_KEY` to the values from the JSON
2. Use "my-decryption-password" to decrypt any encrypted variables in your env file
